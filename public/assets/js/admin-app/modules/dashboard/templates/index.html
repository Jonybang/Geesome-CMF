<h2 ng-if="!page.id">Welcome to Admin panel!</h2>
<h2 ng-if="page.id">Edit page data</h2>

<button ng-if="!page.id" class="btn btn-success" ng-click="savePage()">Create page</button>
<button ng-if="page.id" class="btn btn-primary" ng-click="savePage()">Save page</button>

<br>

<uib-alert ng-if="alert" type="success" close="closeAlert()" dismiss-on-timeout="3000">{{alert}}</uib-alert>

<br>

<div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Main data</h3>
            </div>
            <div class="panel-body">
                <label>Title:</label>
                <text-input ng-model="page.title" is-edit="true" has-error="hasErrors.title" ng-model-options="{debounce: 500}"></text-input>

                <div>
                    <a href ng-click="subTitleDescriptionShow = !subTitleDescriptionShow" ng-class="{'dropup': subTitleDescriptionShow}">
                        Edit sub title and description <span class="caret"></span><br>
                    </a>
                    <div ng-if="subTitleDescriptionShow">
                        <label>Sub title:</label>
                        <text-input ng-model="page.sub_title" has-error="hasErrors.sub_title" is-edit="true"></text-input>

                        <label>Description:</label>
                        <text-input ng-model="page.description" has-error="hasErrors.description" type="textarea" is-edit="true"></text-input>
                    </div>
                </div>

                <label>Content:</label>

                <wiz-markdown-editor content="page.content" textareaclass="form-control">
                    <wiz-toolbar-button command="bold">Bold</wiz-toolbar-button>
                    <wiz-toolbar-button command="italic">Italic</wiz-toolbar-button>
                    <wiz-toolbar-button command="undo">UNDO</wiz-toolbar-button>
                    <wiz-toolbar-button command="redo">REDO</wiz-toolbar-button>
                    <wiz-toolbar-button command="heading">HEADING</wiz-toolbar-button>
                    <wiz-toolbar-button command="code">CODE</wiz-toolbar-button>
                    <wiz-toolbar-button command="ullist">ULLIST</wiz-toolbar-button>
                    <wiz-toolbar-button command="ollist">OLLIST</wiz-toolbar-button>
                    <wiz-toolbar-button command="indent">INDENT</wiz-toolbar-button>
                    <wiz-toolbar-button command="outdent">OUTDENT</wiz-toolbar-button>
                    <wiz-toolbar-button command="link">LINK</wiz-toolbar-button>
                    <wiz-toolbar-button command="img">IMG</wiz-toolbar-button>
                    <wiz-toolbar-button command="hr">HR</wiz-toolbar-button>
                    <wiz-toolbar-button command="h0">H0</wiz-toolbar-button>
                    <wiz-toolbar-button command="h1">H1</wiz-toolbar-button>
                    <wiz-toolbar-button command="h2">H2</wiz-toolbar-button>
                    <wiz-toolbar-button command="h3">H3</wiz-toolbar-button>
                    <wiz-toolbar-button command="h4">H4</wiz-toolbar-button>
                    <wiz-toolbar-button command="h5">H5</wiz-toolbar-button>
                    <wiz-toolbar-button command="h6">H6</wiz-toolbar-button>
                </wiz-markdown-editor>
            </div>
            <div class="panel-footer">
                <label>Content preview:</label>
                <wiz-markdown content="page.content"></wiz-markdown>
            </div>

            <div class="panel-body">
                <label>Tags:</label>
                <select-input ng-model="page.tags_ids" has-error="hasErrors.tags_ids" ng-resource="models.tags" ng-resource-fields="fields.tags" is-edit="true" adder="true" type="multiselect"></select-input>

                <h4>Sub fields:</h4>
                <sub-fields-list ng-model="sub_fields" page-resource="page" api="subFieldsApi"></sub-fields-list>
                <button class="btn btn-default" ng-click="addSubField()" title="Add SubField"><span class="glyphicon glyphicon-plus"></span></button>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Technical data</h3>
            </div>
            <div class="panel-body">
                <label>Template:</label>
                <select-input ng-model="page.template_id" has-error="hasErrors.template_id" ng-resource="models.templates" ng-resource-fields="fields.templates" is-edit="true" adder="true"></select-input>

                <div>
                    <a href ng-click="templateInfoShow = !templateInfoShow" ng-class="{'dropup': templateInfoShow}">
                        Edit template data <span class="caret"></span><br>
                    </a>
                    <div ng-if="templateInfoShow">
                        <label>Controller Actions:</label>
                        <select-input ng-model="page.controller_actions_ids" has-error="hasErrors.controller_actions_ids" ng-resource="models.controller_actions" ng-resource-fields="fields.controller_actions" is-edit="true" adder="true" type="multiselect"></select-input>
                        <div><small>Add actions to some laravel controllers, than bind they to template by names(example: 'SomeController@someAction') for execute when page render and get data from action result returned.</small></div>
                    </div>
                </div>

                <label>Alias:</label>
                <text-input ng-model="page.alias" has-error="hasErrors.alias" is-edit="true"></text-input>

                <label>Published:
                    <input ng-model="page.is_published" has-error="hasErrors.is_published" type="checkbox" class="form-control">
                </label>

                <div>
                    <a href ng-click="menuInfoShow = !menuInfoShow" ng-class="{'dropup': menuInfoShow}">
                        Edit menu info <span class="caret"></span><br>
                    </a>
                    <div ng-if="menuInfoShow">
                        <label>Menu title:</label>
                        <text-input ng-model="page.menu_title" has-error="hasErrors.menu_title" is-edit="true"></text-input>

                        <label>Menu index:</label>
                        <text-input ng-model="page.menu_index" has-error="hasErrors.menu_index" is-edit="true"></text-input>

                        <label>Is hide from menu:
                            <input ng-model="page.is_menu_hide" has-error="hasErrors.is_menu_hide" type="checkbox" class="form-control">
                        </label>
                    </div>
                </div>

                <label>Parent:</label>
                <select-input ng-model="page.parent_page_id" has-error="hasErrors.parent_page_id" ng-resource="models.pages" ng-resource-fields="fields.pages" is-edit="true" adder="true"></select-input>

                <label>Author:</label>
                <select-input ng-model="page.author_id" has-error="hasErrors.author_id" ng-resource="models.users" ng-resource-fields="fields.users" is-edit="true" adder="true"></select-input>
            </div>
        </div>
    </div>
</div>

<button ng-if="!page.id" class="btn btn-success" ng-click="savePage()">Create page</button>
<button ng-if="page.id" class="btn btn-primary" ng-click="savePage()">Save page</button>