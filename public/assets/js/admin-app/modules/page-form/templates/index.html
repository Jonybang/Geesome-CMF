<div class="btn-group btn-group-lg pull-right" role="group" aria-label="...">
    <a target="_self" ng-href="/{{page.page_uri}}" ng-disabled="!page.id" class="btn btn-default">Open page</a>
</div>

<h2 ng-if="!page.id">Add new page!</h2>
<h2 ng-if="page.id">Edit page data</h2>

<button ng-if="!page.id" class="btn btn-success" ng-click="savePage()">Create page</button>
<button ng-if="page.id" class="btn btn-primary" ng-click="savePage()">Save page</button>

<br>
<uib-alert ng-if="alert" type="success" close="closeAlert()" dismiss-on-timeout="3000">{{alert}}</uib-alert>
<br>

<div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Main data</h3>
            </div>
            <div class="panel-body">
                <label>Title:</label>
                <ae-text-input ng-model="page.title" is-edit="true" has-error="hasErrors.title" ng-model-options="{debounce: 500}"></ae-text-input>

                <div>
                    <a href ng-click="subTitleDescriptionShow = !subTitleDescriptionShow" ng-class="{'dropup': subTitleDescriptionShow}">
                        Edit sub title and description <span class="caret"></span><br>
                    </a>
                    <div ng-if="subTitleDescriptionShow">
                        <label>Sub title:</label>
                        <ae-text-input ng-model="page.sub_title" has-error="hasErrors.sub_title" is-edit="true"></ae-text-input>

                        <label>Description:</label>
                        <ae-text-input ng-model="page.description" has-error="hasErrors.description" type="textarea" is-edit="true"></ae-text-input>
                    </div>
                </div>

                <label>Content:</label>

                <wiz-markdown-editor content="page.content" textareaclass="form-control">
                    <wiz-toolbar-button command="bold">Bold</wiz-toolbar-button>
                    <wiz-toolbar-button command="italic">Italic</wiz-toolbar-button>
                    <wiz-toolbar-button command="undo">UNDO</wiz-toolbar-button>
                    <wiz-toolbar-button command="redo">REDO</wiz-toolbar-button>
                    <wiz-toolbar-button command="heading">HEADING</wiz-toolbar-button>
                    <wiz-toolbar-button command="code">CODE</wiz-toolbar-button>
                    <wiz-toolbar-button command="ullist">ULLIST</wiz-toolbar-button>
                    <wiz-toolbar-button command="ollist">OLLIST</wiz-toolbar-button>
                    <wiz-toolbar-button command="indent">INDENT</wiz-toolbar-button>
                    <wiz-toolbar-button command="outdent">OUTDENT</wiz-toolbar-button>
                    <wiz-toolbar-button command="link">LINK</wiz-toolbar-button>
                    <wiz-toolbar-button command="img">IMG</wiz-toolbar-button>
                    <wiz-toolbar-button command="hr">HR</wiz-toolbar-button>
                    <wiz-toolbar-button command="h0">H0</wiz-toolbar-button>
                    <wiz-toolbar-button command="h1">H1</wiz-toolbar-button>
                    <wiz-toolbar-button command="h2">H2</wiz-toolbar-button>
                    <wiz-toolbar-button command="h3">H3</wiz-toolbar-button>
                    <wiz-toolbar-button command="h4">H4</wiz-toolbar-button>
                    <wiz-toolbar-button command="h5">H5</wiz-toolbar-button>
                    <wiz-toolbar-button command="h6">H6</wiz-toolbar-button>
                </wiz-markdown-editor>
            </div>
            <div class="panel-footer">
                <label>Content preview:</label>
                <wiz-markdown content="page.content"></wiz-markdown>
            </div>

            <div class="panel-body">
                <label>Tags:</label>
                <ae-select-input ng-model="page.tags_ids" has-error="hasErrors.tags_ids" ng-resource="models.tags" ng-resource-fields="fields.tags" is-edit="true" adder="true" type="multiselect"></ae-select-input>
            </div>

            <div class="panel-body">
                <h4>Sub fields:</h4>
                <sub-fields-manager ng-model="sub_fields" page-resource="page" api="subFieldsApi" refresh-sub-fields="getSubFields()"></sub-fields-manager>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Technical data</h3>
            </div>
            <div class="panel-body">
                <label>Template:</label>
                <ae-select-input ng-model="page.template_id" has-error="hasErrors.template_id" ng-resource="models.templates" ng-resource-fields="fields.templates" is-edit="true" adder="true"></ae-select-input>

                <div>
                    <a href ng-click="templateInfoShow = !templateInfoShow" ng-class="{'dropup': templateInfoShow}">
                        Edit template data <span class="caret"></span><br>
                    </a>
                    <div ng-if="templateInfoShow">
                        <div class="alert alert-warning">
                            <label>Controller Actions:</label>
                            <ae-select-input ng-model="page.controller_actions_ids" or-name-field="key" has-error="hasErrors.controller_actions_ids" ng-resource="models.controller_actions" ng-resource-fields="fields.controller_actions" is-edit="true" adder="true" type="multiselect"></ae-select-input>

                            <div><small>Add actions to some laravel controllers, than bind they to template by names(example: 'SomeController@someAction') for execute when page render and get data from action result returned.</small></div>
                        </div>
                    </div>
                </div>

                <label>Alias:</label>
                <ae-text-input ng-model="page.alias" has-error="hasErrors.alias" is-edit="true"></ae-text-input>

                <label>Published:
                    <ae-bool-input ng-model="page.is_published" has-error="hasErrors.is_published" is-edit="true"></ae-bool-input>
                </label>

                <div>
                    <a href ng-click="menuInfoShow = !menuInfoShow" ng-class="{'dropup': menuInfoShow}">
                        Edit menu info <span class="caret"></span><br>
                    </a>
                    <div ng-if="menuInfoShow">
                        <label>Menu title:</label>
                        <ae-text-input ng-model="page.menu_title" has-error="hasErrors.menu_title" is-edit="true"></ae-text-input>

                        <label>Menu index:</label>
                        <ae-text-input ng-model="page.menu_index" has-error="hasErrors.menu_index" is-edit="true"></ae-text-input>

                        <label>
                            Is hide from menu:
                            <ae-bool-input ng-model="page.is_menu_hide" has-error="hasErrors.is_published" is-edit="true"></ae-bool-input>
                        </label>
                    </div>
                </div>

                <label>Parent:</label>
                <ae-select-input ng-model="page.parent_page_id" name-field="title" has-error="hasErrors.parent_page_id" ng-resource="models.pages" ng-resource-fields="fields.pages" is-edit="true" adder="true" refresh-list-on="page"></ae-select-input>

                <label>Author:</label>
                <ae-select-input ng-model="page.author_id" has-error="hasErrors.author_id" ng-resource="models.users" ng-resource-fields="fields.users" is-edit="true" adder="true"></ae-select-input>

                <div>
                    <a href ng-click="subInfoShow = !subInfoShow" ng-class="{'dropup': subInfoShow}">
                        Edit sub info <span class="caret"></span><br>
                    </a>
                    <div ng-if="subInfoShow">
                        <label>
                            Is deleted:
                            <ae-bool-input ng-model="page.is_deleted" has-error="hasErrors.is_deleted" is-edit="true"></ae-bool-input>
                        </label>

                        <label>
                            Is abstract page(has no body, but have children, as section):
                            <ae-bool-input ng-model="page.is_abstract" has-error="hasErrors.is_abstract" is-edit="true"></ae-bool-input>
                        </label>

                        <label>
                            Is part of parent page(as page block):
                            <ae-bool-input ng-model="page.is_part" has-error="hasErrors.is_part" is-edit="true"></ae-bool-input>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<button ng-if="!page.id" class="btn btn-success" ng-click="savePage()">Create page</button>
<button ng-if="page.id" class="btn btn-primary" ng-click="savePage()">Save page</button>