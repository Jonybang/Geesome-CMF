<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/admin/">Admin Panel</a>
        <ul class="nav navbar-nav navbar-left">
            <li><a href="/" target="_self">Site Content</a></li>
        </ul>
    </div>

    <!-- Top Menu Items -->
    <ul class="nav navbar-right top-nav">
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user"></i> {{cur_user.name}} <b class="caret"></b></a>
            <ul class="dropdown-menu">
                <li>
                    <a href="/admin/settings"><i class="fa fa-fw fa-gear"></i> Settings</a>
                </li>
                <li class="divider"></li>
                <li>
                    <a href="/logout" target="_self"><i class="fa fa-fw fa-power-off"></i> Log Out</a>
                </li>
            </ul>
        </li>
    </ul>
</nav>

<script type="text/ng-template" id="list.html">
    <a href ng-click="page.hide_children = !page.hide_children" >{{page.title}}</a>
    <ul dnd-list="page.child_pages" ng-class="['child_pages', {'empty':!page.child_pages.length}]">
        <li ng-repeat="page in page.child_pages"
            dnd-draggable="page"
            dnd-effect-allowed="move"
            dnd-moved="$parent.$parent.page.child_pages.splice($index, 1)"
            dnd-selected="models.selected = page"
            ng-class="{selected: models.selected === page}"
            ng-include="'list.html'"
            ui-sref="app.page({pageId: page.id})">
        </li>
    </ul>
</script>

<div class="btn-group" role="group">
    <button ng-repeat="tab in app.tabs" type="button" ng-class="['btn', tab.name == app.activeTab ? 'btn-primary' : 'btn-default']" ng-click="app.activeTab = tab.name">{{tab.title}}</button>
</div>

<div ng-if="app.activeTab == 'pages-tree'">
    <div class="pages-tree">
        <div class="btn-group btn-group-justified">
            <div class="btn-group" role="group">
                <a class="btn btn-default btn-sm" href="/admin/page"><span class="glypicon glyphicon-plus"></span> Add page</a>
            </div>
        </div>

        <ul dnd-list="app.pages_tree" class="list-unstyled margin-top">
            <li ng-repeat="page in app.pages_tree"
                dnd-draggable="page"
                dnd-effect-allowed="move"
                dnd-moved="app.pages_tree.splice($index, 1)"
                dnd-selected="models.selected = page"
                ng-class="{selected: models.selected === page}"
                ng-include="'list.html'"
                ui-sref="app.page({pageId: page.id})">
            </li>
        </ul>
    </div>
    <div class="pages-content">
        <ui-view></ui-view>
    </div>
</div>

<div ng-if="app.activeTab == 'db-manage'">
    <tabs data="app.menuList" type="pills" vertical="true" class="main-menu"></tabs>
</div>